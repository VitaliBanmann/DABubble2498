<div class="thread-panel" *ngIf="isThreadOpen">
  <div class="thread-header">
    <h3>Thread</h3>
    <button class="close-button" (click)="closeThread()" title="Schließen">×</button>
  </div>

  <div class="thread-container">
    <div *ngIf="isLoadingThread" class="loading">Thread wird geladen...</div>
    <div *ngIf="!isLoadingThread && threadMessages.length === 0" class="empty-state">
      <p>Keine Antworten</p>
    </div>

    <div *ngFor="let message of threadMessages" class="thread-message">
      <div class="avatar" style="width: 28px; height: 28px; border-radius: 50%; background: linear-gradient(135deg, #5b5de6 0%, #7c7fee 100%); flex-shrink: 0;"></div>
      <div class="content">
        <div class="header">
          <span class="name">User</span>
          <span class="time">{{ getMessageTime(message.timestamp) }}</span>
        </div>
        <div class="text">{{ message.text }}</div>
      </div>
    </div>
  </div>

  <div class="thread-input">
    <textarea
      [(ngModel)]="newReply"
      (keyup.enter)="handleEnterKey($event)"
      placeholder="Antwort schreiben..."
      rows="2"
      [disabled]="isSending"
    ></textarea>
    <button
      type="button"
      (click)="sendReply()"
      [disabled]="!newReply.trim() || isSending"
      class="reply-button"
    >
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 L4.13399899,1.16950027 C3.34915502,0.9124029 2.40734225,1.0224892 1.77946707,1.4937813 C0.994623095,2.12213197 0.837654326,3.0647163 1.15159189,3.85020324 L3.03521743,10.2911962 C3.03521743,10.4482935 3.19218622,10.6053909 3.50612381,10.6053909 L16.6915026,11.3908779 C16.6915026,11.3908779 17.1624089,11.3908779 17.1624089,10.8195856 L17.1624089,12.0031671 C17.1624089,12.5744593 16.6915026,12.4744748 16.6915026,12.4744748 Z"/>
      </svg>
    </button>
  </div>
</div>
